* {
    box-sizing: border-box;
    --control-height: 35px;
    --top-bar-height: 35px;
}

.babylon-container {
    display: grid;
    grid-template-columns: 1fr;
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    min-height: 0;
    min-width: 0;
    gap: 2px;
    padding: 2px;
    position: relative;
    /*border: 2px solid yellowgreen;*/
    user-select: none;
    -webkit-user-select: none; /* Safari */

}

.babylon-container.babylon-controls-inside {
    grid-template-rows: 1fr;
    grid-template-areas: "canvas";
}

.babylon-container.babylon-controls-outside {
    grid-template-rows: 1fr auto;
    grid-template-areas: "canvas" "controls";
}

.babylon-container .babylon-canvas-container {
    grid-area: canvas;
    width: 100%;
    height: 100%;
    max-height: 100%;
    max-width: 100%;
    min-width: 0;
    min-height: 0;
    justify-content: center;
    align-items: center;
    /*border: 2px solid green;*/
    user-select: none;
    -webkit-user-select: none;
}

.babylon-container .babylon-canvas-container .babylon-canvas {
    /*width: 200px;*/
    /*height: 100px;*/
    width: 100%;
    height: 100%;
    max-height: 100%;
    max-width: 100%;
    min-width: 0;
    min-height: 0;
    border-radius: 5px;
    /*border: 2px solid yellow;*/
    user-select: none;
    -webkit-user-select: none;

}

.babylon-canvas:focus {
    outline: none;
}

.babylon-container .babylon-controls {
    display: grid;
    grid-template-rows: 1fr;
    grid-template-columns: 1fr auto;
    grid-template-areas: "connection buttons";
    gap: 2px;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: var(--control-height);
    max-height: 10%;
    min-width: 0;
    min-height: 0;
    border: 1px solid #333;
    border-radius: 5px;
}

.babylon-container.babylon-controls-inside .babylon-controls {
    position: absolute;
    bottom: 5px;
    right: 5px;
    border: none;
    overflow: visible;
}

.babylon-container.babylon-controls-outside .babylon-controls {
    grid-area: controls;
}

.babylon-container .babylon-controls .connection {
    display: grid;
    grid-area: connection;
    grid-template-columns: auto auto 1fr;
    grid-template-rows: 1fr;
    grid-template-areas: "connection-circle connection-messages";
    gap: 2px;
    justify-content: center;
    align-items: center;
    width: auto;
    /*width: 100px;*/
    z-index: 1000;
    height: 100%;
    max-height: 100%;
    margin-left: 15px;
    border-radius: 5px;
}

.babylon-container .babylon-controls .connection .connection-circle {
    grid-area: connection-circle;
    height: 15px;
    aspect-ratio: 1 / 1;
    /*max-height: 100%;*/
    border-radius: 50%;
    background: yellowgreen;
    opacity: 0.9;
    border: 1px solid black;
}

.babylon-container .babylon-controls .connection .connection-messages {
    grid-area: connection-messages;
    display: flex;
    flex-direction: column;
    gap: 2px;
    justify-content: center;
    align-items: flex-start;
    width: 100%;
    /*height: 100%;*/
    /*max-height: 100%;*/
    /*border: 1px solid yellowgreen;*/
    font-family: 'Roboto', sans-serif;
    font-size: 12px;
    background: #222;
    opacity: 0.6;
    border-radius: 5px;
    max-height: 90%;
    height: 60%;
    color: white;
    padding: 2px 4px;
}

.babylon-container .babylon-controls .buttons {
    display: grid;
    grid-area: buttons;
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-rows: 1fr;
    aspect-ratio: 3 / 1;
    gap: 2px;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    min-width: 0;
    min-height: 0;
    border-radius: 5px;
    padding: 0;
    opacity: 0.8;
    position: relative;
    overflow: visible;
}

.babylon-container .top-bar {
    display: flex;
    justify-content: space-between; /* Push left and right elements apart */
    align-items: center; /* Vertically center the content */
    position: absolute;
    top: 5px;
    left: 5px;
    right: 5px;
    height: var(--top-bar-height, 35px);
    max-height: 10%;
    min-width: 0;
    min-height: 0;
    opacity: 0.6;
    /*border: 1px solid red;*/
    border-radius: 5px;
    padding: 2px 4px; /* Optional: spacing from the edges */
}

.babylon-container .top-bar .title {
    font-size: 1.2em;
    height: 100%;
    justify-content: center;
    align-items: center;
    display: flex;
    font-family: 'Roboto', sans-serif;
    color: white;
    background-color: #222;
    border-radius: 5px;
    padding: 0 10px;
}

.babylon-container .top-bar .time {
    font-size: 1em;
    height: 100%;
    justify-content: center;
    align-items: center;
    display: flex;
    font-family: 'Roboto', sans-serif;
    color: white;
    background-color: #222;
    border-radius: 5px;
    padding: 0 10px;
}

.babylon-container .terminal-overlay {
    position: absolute;
    left: 5px;
    right: 5px;
    z-index: 1000;
    display: flex;
    justify-content: center;
    opacity: 0.5;
    background: rgba(0, 0, 0, 1);
    border-radius: 5px;
    /*pointer-events: none;*/
}

.babylon-container .debug-overlay .terminal-close-button-container,
.babylon-container .terminal-overlay .terminal-close-button-container {
    position: absolute;
    top: 5px;
    right: 5px;
    cursor: pointer;
    /*background: red;*/
    opacity: 1;
    width: 20px;
    height: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 3px;
}

/* Debug overlay (anchored right; clicks pass through by default) */
.babylon-container .debug-overlay {
    position: absolute;
    left: auto;
    right: 5px;
    width: auto;
    z-index: 1000;
    display: none; /* toggled via JS to flex */
    justify-content: flex-end;
    align-items: stretch;
    background: transparent;
    pointer-events: none; /* let events hit the canvas */
}

/* Panel (scrollable; no pointer capture so drags pass through) */
.babylon-container .debug-overlay .debug-panel {
    pointer-events: none;
    width: min(340px, 28vw);
    max-height: 100%;
    margin: 0;
    padding: 10px 12px;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 8px;
    color: #eaeaea;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    font-size: 12px;
    line-height: 1.4;
    overflow: auto; /* scrolled via JS wheel interceptor */
    overscroll-behavior: contain; /* keep scroll contained to this panel */
}

/* Close button (must be clickable) */
.babylon-container .debug-overlay .debug-close-button-container {
    pointer-events: auto;
}

/* Root layout */
.debug-root {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Category block */
.debug-category {
    display: block;
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 6px;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.03);
}

/* Category title (clickable; caret indicator inside) */
.debug-category-title {
    pointer-events: auto; /* allow toggling */
    width: 100%;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 8px;
    background: rgba(255, 255, 255, 0.06);
    border: none;
    color: #fff;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    font-size: 12px;
    cursor: pointer;
}

/* Caret indicator */
.debug-category-title .caret {
    display: inline-block;
    width: 0;
    height: 0;
    border-left: 5px solid currentColor;
    border-top: 4px solid transparent;
    border-bottom: 4px solid transparent;
    transform: rotate(90deg); /* expanded by default (down) */
    transition: transform 120ms ease;
    opacity: 0.9;
    margin-right: 2px;
}

.debug-category.collapsed .debug-category-title .caret {
    transform: rotate(0deg); /* collapsed (right) */
}

/* Category body (visible but non-interactive so clicks/drag pass through) */
.debug-body {
    pointer-events: none;
    padding: 6px 6px 8px 6px;
}

.debug-category.collapsed .debug-body {
    display: none;
}

/* Fields */
.debug-field {
    display: flex;
    gap: 8px;
    padding: 1px 6px 1px 12px;
}

.debug-field.indent {
    padding-left: 24px;
}

.debug-label {
    min-width: 160px;
    color: #b9c2cf;
}

.debug-value {
    color: #ffffff;
    word-break: break-word;
}

/* Optional subcategory styling */
.debug-subcategory {
    margin-top: 6px;
}

.debug-subcategory-title {
    font-weight: 600;
    font-size: 11px;
    opacity: 0.9;
    margin: 2px 0 2px 12px;
}


.buttonItem.terminal-button {
    overflow: visible; /* overrides the general .buttonItem overflow:hidden */
}

/* Small Apple-style red badge at the top-right corner */
.buttonItem .terminalBadge {
    position: absolute;
    top: -4px; /* negative so it protrudes a bit */
    right: -4px; /* negative so it protrudes a bit */
    min-width: 16px;
    height: 16px;
    padding: 0 4px; /* lets 2â€“3 digits fit while staying rounded */
    border-radius: 999px;
    display: none; /* hidden when count is 0 */
    align-items: center;
    justify-content: center;

    background: #ff3b30; /* Apple "system red" */
    color: #fff;
    font-size: 10px;
    font-weight: 700;
    line-height: 1;
    pointer-events: none; /* never block clicks on the button */

    /* subtle ring so it reads on dark backgrounds */
    box-shadow: 0 0 0 1.5px rgba(0, 0, 0, 0.85);
    z-index: 2; /* above button icon */
}


/* --- Record Button core container ------------------------------------------- */
.buttonItem.record-button {
    position: relative;
    overflow: visible;
}

/* When recording, add a red pulsating ring */
.buttonItem.record-button.is-recording {
    border: 3px solid rgba(255, 59, 48, 1) !important; /* iOS system red */
    animation: rec-glow 1.05s ease-in-out infinite;
}

/* Pulse animation for the red ring */
@keyframes rec-glow {
    0%, 100% {
        opacity: 1;
        /*transform: scale(1);*/
    }
    50% {
        opacity: 0.6;
        /*transform: scale(1.02);*/
    }
}

.buttonItem.record-button .record-timer {
    /* Layout & positioning (centered above the button) */
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: calc(100% + 6px); /* sits just above the top edge of the button */
    display: none; /* shown only while .is-recording is present */
    z-index: 2;
    pointer-events: none;

    /* Visuals */
    background: #ff3b30; /* iOS system red */
    color: #ffffff;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
    font-size: 11px;
    font-weight: 700;
    line-height: 1;
    padding: 4px 6px;
    border-radius: 999px;

    /* Subtle outline so it reads on any background */
    box-shadow: 0 0 0 1.5px rgba(0, 0, 0, 0.85), 0 2px 6px rgba(0, 0, 0, 0.35);
}


/* Show the timer only while recording */
.buttonItem.record-button.is-recording .record-timer {
    display: inline-flex;
    align-items: center;
    justify-content: center;
}




